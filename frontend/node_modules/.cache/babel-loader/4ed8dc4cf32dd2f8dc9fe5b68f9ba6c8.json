{"remainingRequest":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/babel-loader/lib/index.js!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Payment.vue?vue&type=template&id=3a0cf106&scoped=true","dependencies":[{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Payment.vue","mtime":1668582891177},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/babel.config.js","mtime":1668582891128},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668583024883},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/babel-loader/lib/index.js","mtime":1668583028072},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1668583030037},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668583024883},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1668583028011}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IHJlc29sdmVDb21wb25lbnQgYXMgX3Jlc29sdmVDb21wb25lbnQsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgY3JlYXRlRWxlbWVudFZOb2RlIGFzIF9jcmVhdGVFbGVtZW50Vk5vZGUsIHJlbmRlckxpc3QgYXMgX3JlbmRlckxpc3QsIEZyYWdtZW50IGFzIF9GcmFnbWVudCwgb3BlbkJsb2NrIGFzIF9vcGVuQmxvY2ssIGNyZWF0ZUVsZW1lbnRCbG9jayBhcyBfY3JlYXRlRWxlbWVudEJsb2NrLCB0b0Rpc3BsYXlTdHJpbmcgYXMgX3RvRGlzcGxheVN0cmluZywgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIHB1c2hTY29wZUlkIGFzIF9wdXNoU2NvcGVJZCwgcG9wU2NvcGVJZCBhcyBfcG9wU2NvcGVJZCB9IGZyb20gInZ1ZSI7CmltcG9ydCBfaW1wb3J0c18wIGZyb20gJ0AvYXNzZXRzL3RhYmxlLnBuZyc7CmNvbnN0IF93aXRoU2NvcGVJZCA9IG4gPT4gKF9wdXNoU2NvcGVJZCgiZGF0YS12LTNhMGNmMTA2IiksIG4gPSBuKCksIF9wb3BTY29wZUlkKCksIG4pOwpjb25zdCBfaG9pc3RlZF8xID0gewogIGNsYXNzOiAicGF5bWVudCIKfTsKY29uc3QgX2hvaXN0ZWRfMiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImgxIiwgewogIGNsYXNzOiAic2VjdGlvbi10aXRsZSIKfSwgIllvdXIgT3JkZXIiLCAtMSAvKiBIT0lTVEVEICovKSk7CmNvbnN0IF9ob2lzdGVkXzMgPSB7CiAgY2xhc3M6ICJidXJnZXIiCn07CmNvbnN0IF9ob2lzdGVkXzQgPSB7CiAgImRhdGEtdGgiOiAiUHJvZHVjdCIKfTsKY29uc3QgX2hvaXN0ZWRfNSA9IHsKICBjbGFzczogInJvdyIKfTsKY29uc3QgX2hvaXN0ZWRfNiA9IHsKICAiZGF0YS10aCI6ICJQcmljZSIKfTsKY29uc3QgX2hvaXN0ZWRfNyA9IHsKICAiZGF0YS10aCI6ICJRdWFudGl0eSIKfTsKY29uc3QgX2hvaXN0ZWRfOCA9IHsKICAiZGF0YS10aCI6ICJTdWJ0b3RhbCIsCiAgY2xhc3M6ICJ0ZXh0LWNlbnRlciIKfTsKY29uc3QgX2hvaXN0ZWRfOSA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJwYXlfYnRuIgp9Owpjb25zdCBfaG9pc3RlZF8xMCA9IHsKICAiZGF0YS10aCI6ICJUb3RhbCIsCiAgY2xhc3M6ICJ0ZXh0LWNlbnRlciIKfTsKY29uc3QgX2hvaXN0ZWRfMTEgPSB7CiAga2V5OiAxLAogIGNsYXNzOiAiaW1hZ2Vib3giCn07CmNvbnN0IF9ob2lzdGVkXzEyID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgoKSA9PiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaW1nIiwgewogIHNyYzogX2ltcG9ydHNfMAp9LCBudWxsLCAtMSAvKiBIT0lTVEVEICovKSk7CmNvbnN0IF9ob2lzdGVkXzEzID0gewogIGNsYXNzOiAiYm90dG9tLWJhciIKfTsKY29uc3QgX2hvaXN0ZWRfMTQgPSAvKiNfX1BVUkVfXyovX3dpdGhTY29wZUlkKCgpID0+IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgY2xhc3M6ICJmaXJzdF9saW5lIgp9LCAiU3VjY2Vzc2Z1bGx5IFBhaWQhIiwgLTEgLyogSE9JU1RFRCAqLykpOwpjb25zdCBfaG9pc3RlZF8xNSA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIHsKICBjbGFzczogInNlY29uZF9saW5lIgp9LCAiV2UgYXJlIG5vdyBwcmVwYXJpbmcgeW91ciBmb29kLi4ucGxlYXNlIHdhaXQiLCAtMSAvKiBIT0lTVEVEICovKSk7CmNvbnN0IF9ob2lzdGVkXzE2ID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgoKSA9PiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaDMiLCBudWxsLCAiQ2hlY2sgbXkgb3JkZXIgc3RhdHVzIiwgLTEgLyogSE9JU1RFRCAqLykpOwpjb25zdCBfaG9pc3RlZF8xNyA9IFtfaG9pc3RlZF8xNl07CmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoX2N0eCwgX2NhY2hlLCAkcHJvcHMsICRzZXR1cCwgJGRhdGEsICRvcHRpb25zKSB7CiAgY29uc3QgX2NvbXBvbmVudF9OYXZCYXIgPSBfcmVzb2x2ZUNvbXBvbmVudCgiTmF2QmFyIik7CiAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jayhfRnJhZ21lbnQsIG51bGwsIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9OYXZCYXIpLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2hvaXN0ZWRfMiwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgidGFibGUiLCBudWxsLCBbKF9vcGVuQmxvY2sodHJ1ZSksIF9jcmVhdGVFbGVtZW50QmxvY2soX0ZyYWdtZW50LCBudWxsLCBfcmVuZGVyTGlzdCgkZGF0YS5jYXJ0LCBpdGVtID0+IHsKICAgIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIHsKICAgICAga2V5OiBpdGVtLm5hbWUsCiAgICAgIGNsYXNzOiAiY2FydDEiCiAgICB9LCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgidHIiLCBudWxsLCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMywgW19jcmVhdGVFbGVtZW50Vk5vZGUoInRkIiwgX2hvaXN0ZWRfNCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzUsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBudWxsLCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaDQiLCBudWxsLCBfdG9EaXNwbGF5U3RyaW5nKGl0ZW0ubmFtZSksIDEgLyogVEVYVCAqLyldKV0pXSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInRkIiwgX2hvaXN0ZWRfNiwgIiQiICsgX3RvRGlzcGxheVN0cmluZyhpdGVtLnByaWNlKSwgMSAvKiBURVhUICovKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgidGQiLCBfaG9pc3RlZF83LCBfdG9EaXNwbGF5U3RyaW5nKGl0ZW0uYW1vdW50KSwgMSAvKiBURVhUICovKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgidGQiLCBfaG9pc3RlZF84LCAiU3VidG90YWw6ICQiICsgX3RvRGlzcGxheVN0cmluZygkb3B0aW9ucy5zdWJ0b3RhbChpdGVtLmFtb3VudCwgaXRlbS5wcmljZSkpLCAxIC8qIFRFWFQgKi8pXSldKV0pOwogIH0pLCAxMjggLyogS0VZRURfRlJBR01FTlQgKi8pKV0pLCAkZGF0YS5wYWlkID09IGZhbHNlID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgX2hvaXN0ZWRfOSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImgyIiwgX2hvaXN0ZWRfMTAsICJUb3RhbDogJCIgKyBfdG9EaXNwbGF5U3RyaW5nKCRvcHRpb25zLnRvdGFsKCkpLCAxIC8qIFRFWFQgKi8pLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJidXR0b24iLCB7CiAgICBvbkNsaWNrOiBfY2FjaGVbMF0gfHwgKF9jYWNoZVswXSA9ICguLi5hcmdzKSA9PiAkb3B0aW9ucy5tYWtlX3BheSAmJiAkb3B0aW9ucy5tYWtlX3BheSguLi5hcmdzKSkKICB9LCAiIE1ha2UgUGF5bWVudCAiKV0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKSwgJGRhdGEucGFpZCA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIF9ob2lzdGVkXzExLCBbX2hvaXN0ZWRfMTIsIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzEzLCBbX2hvaXN0ZWRfMTQsIF9ob2lzdGVkXzE1LCBfY3JlYXRlRWxlbWVudFZOb2RlKCJidXR0b24iLCB7CiAgICBvbkNsaWNrOiBfY2FjaGVbMV0gfHwgKF9jYWNoZVsxXSA9ICRldmVudCA9PiB0aGlzLiRyb3V0ZXIucHVzaCgnL29yZGVyJykpLAogICAgY2xhc3M6ICJidXR0b24iCiAgfSwgX2hvaXN0ZWRfMTcpXSldKSkgOiBfY3JlYXRlQ29tbWVudFZOb2RlKCJ2LWlmIiwgdHJ1ZSldKV0sIDY0IC8qIFNUQUJMRV9GUkFHTUVOVCAqLyk7Cn0="},{"version":3,"mappings":";;OA6BaA,UAAwB;;;EA3B5BC,KAAK,EAAE;AAAS;gEACjBC,oBAAyC;EAArCD,KAAK,EAAC;AAAe,GAAC,YAAU;;EAIzBA,KAAK,EAAC;AAAQ;;EACf,SAAO,EAAC;AAAS;;EACZA,KAAK,EAAC;AAAK;;EAMhB,SAAO,EAAC;AAAO;;EACf,SAAO,EAAC;AAAU;;EAElB,SAAO,EAAC,UAAU;EAACA,KAAK,EAAC;;;;EAMlCA,KAAK,EAAC;;;EACH,SAAO,EAAC,OAAO;EAACA,KAAK,EAAC;;;;EAGzBA,KAAK,EAAC;;iEACPC,oBAA8B;EAAzBC,GAAwB,EAAxBH;AAAwB;;EACxBC,KAAK,EAAC;AAAY;iEACvBC,oBAAkD;EAA7CD,KAAK,EAAG;AAAY,GAAC,oBAAkB;iEAC5CC,oBAA6E;EAAxED,KAAK,EAAG;AAAa,GAAC,8CAA4C;iEAGhDC,oBAA8B,YAA1B,uBAAqB;qBAAzBE,WAA8B;;;6DAlCzDC,aAAUC,oBACVJ,oBAqCE,OArCFK,UAqCE,GApCEC,UAAyC,EACzCN,oBAmBQ,mCAlBVO,oBAiBMC,6BAjBgBC,UAAI,EAAZC,IAAI;yBAAlBH,oBAiBM;MAjBuBI,GAAG,EAAED,IAAI,CAACE,IAAI;MAAEb,KAAK,EAAC;QAC/CC,oBAeK,aAdDA,oBAaM,OAbNa,UAaM,GAZNb,oBAMK,MANLc,UAMK,GALDd,oBAIM,OAJNe,UAIM,GAHFf,oBAEM,cADFA,oBAAwB,6BAAjBU,IAAI,CAACE,IAAI,wBAI5BZ,oBAA0C,MAA1CgB,UAA0C,EAAtB,GAAC,oBAAGN,IAAI,CAACO,KAAK,kBAClCjB,oBACK,MADLkB,UACK,mBADqBR,IAAI,CAACS,MAAM,kBAErCnB,oBAAkG,MAAlGoB,UAAkG,EAAvD,aAAW,oBAAGC,iBAAQ,CAACX,IAAI,CAACS,MAAM,EAAET,IAAI,CAACO,KAAK;oCAMxER,UAAI,2BAA/BF,oBAGM,OAHNe,UAGM,GAFFtB,oBAAgE,MAAhEuB,WAAgE,EAAxB,UAAQ,oBAAEF,cAAK,oBACvDrB,oBAAiD;IAAxCwB,OAAK,yCAAEH,+CAAQ;KAAE,gBAAc,0CAEhBZ,UAAI,kBAAhCF,oBAUM,OAVNkB,WAUM,GATFC,WAA8B,EAC9B1B,oBAOM,OAPN2B,WAOM,GANNC,WAAkD,EAClDC,WAA6E,EAC7E7B,oBAGS;IAFAwB,OAAK,2CAAOM,OAAO,CAACC,IAAI;IACzBhC,KAAK,EAAC","names":["_imports_0","class","_createElementVNode","src","_hoisted_16","_createVNode","_component_NavBar","_hoisted_1","_hoisted_2","_createElementBlock","_Fragment","$data","item","key","name","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","price","_hoisted_7","amount","_hoisted_8","$options","_hoisted_9","_hoisted_10","onClick","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","$router","push"],"sourceRoot":"","sources":["/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Payment.vue"],"sourcesContent":["<template v-if=\"user\">\n    <NavBar />\n    <div class =\"payment\">\n        <h1 class=\"section-title\">Your Order</h1>\n        <table>\n      <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n          <tr>\n              <div class=\"burger\">\n              <td data-th=\"Product\">\n                  <div class=\"row\">\n                      <div>\n                          <h4>{{ item.name }}</h4>\n                      </div>\n                  </div>\n              </td>\n              <td data-th=\"Price\">${{ item.price }}</td>\n              <td data-th=\"Quantity\">{{ item.amount }}\n              </td>\n              <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n              \n              </div>\n          </tr>\n      </div>\n        </table>\n    <div class=\"pay_btn\" v-if=\"paid == false\">\n        <h2 data-th=\"Total\" class=\"text-center\">Total: ${{total()}}</h2>\n        <button @click=\"make_pay\"> Make Payment </button>\n    </div>\n    <div class=\"imagebox\" v-if=\"paid\">\n        <img src=\"@/assets/table.png\">\n        <div class=\"bottom-bar\">\n        <div class = \"first_line\">Successfully Paid!</div>\n        <div class = \"second_line\">We are now preparing your food...please wait</div>\n        <button\n                @click=\"this.$router.push('/order')\" \n                class=\"button\"><h3>Check my order status</h3>\n        </button>\n        </div>\n    </div>\n</div>\n  \n        \n  \n    </template>\n  \n  <script>\n  import NavBar from '@/components/NavBar.vue'\n  import firebaseApp from '../firebase.js';\n  import {collection, getDocs} from \"firebase/firestore\";\n  import { getFirestore } from \"firebase/firestore\"\n  import {getAuth, onAuthStateChanged} from 'firebase/auth';\n  import { doc, setDoc,deleteDoc} from \"firebase/firestore\";\n\n  const db = getFirestore(firebaseApp);\n  const auth = getAuth();\n  export default {\n      name: 'payment',\n      components:{\n            NavBar,},\n  data() {\n      return {\n      cart: [],\n      user: false,\n      paid: false,\n      order: [],\n      }\n     \n  },\n  async mounted() {\n  onAuthStateChanged(auth, async (user)=>{\n  if (user) { \n      this.user=user;\n      await this.getAll();\n      if (this.cart.length == 0) {\n        this.$router.push('/menu');\n    }\n  }\n  });\n  },\n  methods: {\n      async getAll() {\n          try {\n              const path1 = String(auth.currentUser.email) + '_orders'\n              //TODO-->pagination\n              console.log(auth.currentUser.email)\n              const cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n              const q = await getDocs(cartRef) //get all docs in collection\n              const orderRef = collection(db, path1)\n              const a = await getDocs(orderRef)\n              \n              q.forEach((doc) => {\n                  this.cart = [...this.cart, doc.data(), ] //push to cart array\n              });\n              a.forEach((doc) => {\n                  //console.log(\"Data read is \" + doc.data())\n                  this.order = [...this.order, doc.data(), ] //push to order array\n                  //console.log(\"Data read is \" + doc.data())\n              });\n              console.log(this.order)\n              //console.log(\"content in order list: \" + this.order.length)\n          } catch (e) {\n              console.log(e);\n          }\n      },\n      subtotal(amount, price){\n              return amount * price\n          },\n      total(){\n          var sum=0;\n          for(let i =0;i<this.cart.length;i++)\n          {\n          \n          sum += this.cart[i].amount*this.cart[i].price;\n          \n          }\n          console.log(sum);\n          return sum; \n      },\n      async make_pay(){\n        const unique_num = String(this.order.length + 1)\n        const path = String(auth.currentUser.email) + '_orders'\n        var name1 = []\n        var amount1 = []\n        var price1 = []\n        const date1 = new Date();\n        console.log(\"cart length is : \" + this.cart.length)\n        try{\n            for (var i = 0; i < this.cart.length; i++) {\n                name1.push(this.cart[i].name)\n                amount1.push(this.cart[i].amount)\n                price1.push(this.cart[i].price)\n                await deleteDoc(doc(db, String(auth.currentUser.email), this.cart[i].name));\n            }\n            const data = {\n                name: name1,\n                amount: amount1,\n                price: price1,\n                date: date1,\n            }\n            console.log(data)\n            await setDoc(doc(db, path, unique_num),data)\n            this.cart.splice(0,this.cart.length)\n            alert(\"Paid successfully!\")\n            this.paid = true\n        } catch(e) {\n            console.log(e);\n        }\n      }\n  }}\n  </script>\n  \n  <style scoped>\n  .payment{\n      text-align: center;\n  }\n  .item{\n      text-align: center;\n  }\n  td{\n      text-align: center;\n      /*padding: 15px;*/\n      width: 500px;\n  }\n  .imagebox {\n    position: relative;\n    display: inline-block;\n  }\n  img {\n      width:  600px;\n      background-color:whitesmoke;\n              height: 300px;\n              object-fit: cover;\n              align-items: center;\n              margin-left: auto;\n              margin-right: auto;\n              position: relative;\n              vertical-align: middle;\n              border: 0;\n    border: 3px solid orangered;\n    border-radius: 12px;\n  }\n  .first_line {\n              position: absolute;\n              top: 30px;\n              left: 80px;\n              /*font-size: 50px;*/\n              font-size: 4vw;\n              color: orange\n          }\n    \n          .second_line{\n              position: absolute;\n              bottom: 150px;\n              left: 30px;\n              /*font-size: 25px;*/\n              font-size: 1.8vw;\n          }\n  .button {\n      position: absolute;\n      background-color: #c77414;\n      color: white;\n      margin:auto;\n      display:block;\n      border-radius: 12px;\n      font-weight: bold;\n      padding: 10px 40px;\n      bottom: 30px;\n      left: 170px;\n  }\n  table, td, th {\n  border: 1px solid black;\n}\n.pay_btn button{\n    background-color: #c77414;\n    color: white;\n}\n  </style>\n"]}]}
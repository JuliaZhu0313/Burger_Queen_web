{"remainingRequest":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/babel-loader/lib/index.js!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Cart.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Cart.vue","mtime":1668582891175},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/babel.config.js","mtime":1668582891128},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668583024883},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/babel-loader/lib/index.js","mtime":1668583028072},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668583024883},{"path":"/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1668583028011}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBmaXJlYmFzZUFwcCBmcm9tICcuLi9maXJlYmFzZS5qcyc7CmltcG9ydCB7IGNvbGxlY3Rpb24sIGdldERvY3MgfSBmcm9tICJmaXJlYmFzZS9maXJlc3RvcmUiOwppbXBvcnQgeyBnZXRGaXJlc3RvcmUsIGRvYywgdXBkYXRlRG9jLCBkZWxldGVEb2MgfSBmcm9tICJmaXJlYmFzZS9maXJlc3RvcmUiOwppbXBvcnQgeyBnZXRBdXRoLCBvbkF1dGhTdGF0ZUNoYW5nZWQgfSBmcm9tICdmaXJlYmFzZS9hdXRoJzsKY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoZmlyZWJhc2VBcHApOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2NhcnQnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjYXJ0OiBbXSwKICAgICAgdXNlcjogZmFsc2UKICAgIH07CiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTsKICAgIG9uQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBhc3luYyB1c2VyID0+IHsKICAgICAgaWYgKHVzZXIpIHsKICAgICAgICB0aGlzLnVzZXIgPSB1c2VyOwogICAgICAgIGF3YWl0IHRoaXMuZ2V0QWxsKCk7CiAgICAgIH0KICAgIH0pOwogICAgLy9hd2FpdCB0aGlzLmdldEFsbCgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldEFsbCgpIHsKICAgICAgY29uc3QgYXV0aCA9IGF3YWl0IGdldEF1dGgoKTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zb2xlLmxvZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKTsKICAgICAgICBjb25zdCBjYXJ0UmVmID0gY29sbGVjdGlvbihkYiwgU3RyaW5nKGF1dGguY3VycmVudFVzZXIuZW1haWwpKTsgLy9yZWZyZW5jZSB0aGUgY29sbGVjdGlvbgogICAgICAgIGNvbnN0IHEgPSBhd2FpdCBnZXREb2NzKGNhcnRSZWYpOyAvL2dldCBhbGwgZG9jcyBpbiBjb2xsZWN0aW9uCiAgICAgICAgcS5mb3JFYWNoKGRvYyA9PiB7CiAgICAgICAgICB0aGlzLmNhcnQgPSBbLi4udGhpcy5jYXJ0LCBkb2MuZGF0YSgpXTsgLy9wdXNoIHRvIGNhcnQgYXJyYXkKICAgICAgICB9KTsKCiAgICAgICAgY29uc29sZS5sb2codGhpcy5jYXJ0KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB9CiAgICB9LAogICAgcGx1cyhpZCkgewogICAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpOwogICAgICB2YXIgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS52YWx1ZTsKICAgICAgdHJ5IHsKICAgICAgICBhKys7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlID0gYTsKICAgICAgICBjb25zdCBkX21pbnVzID0gewogICAgICAgICAgYW1vdW50OiBhCiAgICAgICAgfTsKICAgICAgICB1cGRhdGVEb2MoZG9jKGRiLCBTdHJpbmcoYXV0aC5jdXJyZW50VXNlci5lbWFpbCksIGlkKSwgZF9taW51cyk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcnQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmICh0aGlzLmNhcnRbaV0ubmFtZSA9PSBpZCkgewogICAgICAgICAgICB0aGlzLmNhcnRbaV0uYW1vdW50Kys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGFkZGluZzogICIsIGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIG1pbnVzKGlkKSB7CiAgICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7CiAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlOwogICAgICB0cnkgewogICAgICAgIGlmIChhIDw9IDEpIHsKICAgICAgICAgIGEgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhIC09IDE7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FydC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAodGhpcy5jYXJ0W2ldLm5hbWUgPT0gaWQpIHsKICAgICAgICAgICAgICB0aGlzLmNhcnRbaV0uYW1vdW50LS07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlID0gYTsKICAgICAgICBjb25zdCBkX3BsdXMgPSB7CiAgICAgICAgICBhbW91bnQ6IGEKICAgICAgICB9OwogICAgICAgIHVwZGF0ZURvYyhkb2MoZGIsIFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSwgaWQpLCBkX3BsdXMpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIHJlbW92aW5nIGl0ZW0hIik7CiAgICAgIH0KICAgIH0sCiAgICBzdWJ0b3RhbChhbW91bnQsIHByaWNlKSB7CiAgICAgIHJldHVybiBhbW91bnQgKiBwcmljZTsKICAgIH0sCiAgICBuZXdfZGVsZXRlKGl0ZW0pIHsKICAgICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTsKICAgICAgdHJ5IHsKICAgICAgICBkZWxldGVEb2MoZG9jKGRiLCBTdHJpbmcoYXV0aC5jdXJyZW50VXNlci5lbWFpbCksIGl0ZW0pKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FydC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMuY2FydFtpXS5uYW1lID09IGl0ZW0pIHsKICAgICAgICAgICAgdGhpcy5jYXJ0LnNwbGljZShpLCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYWxlcnQoIkRlbGV0ZSBzdWNjZXNzZnVsbHkhIik7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgcmVtb3ZpbmcgaXRlbSEiKTsKICAgICAgfQogICAgfSwKICAgIG1ha2VfcGF5bWVudCgpIHsKICAgICAgaWYgKHRoaXMuY2FydC5sZW5ndGggPT0gMCkgewogICAgICAgIGFsZXJ0KCJUaGVyZSdzIG5vdGhpbmcgaW4geW91ciBjYXJ0ISIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvcGF5bWVudCcpOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["firebaseApp","collection","getDocs","getFirestore","doc","updateDoc","deleteDoc","getAuth","onAuthStateChanged","db","name","data","cart","user","mounted","auth","getAll","methods","console","log","currentUser","email","cartRef","String","q","forEach","e","plus","id","a","document","getElementById","value","d_minus","amount","i","length","error","minus","d_plus","subtotal","price","new_delete","item","splice","alert","make_payment","$router","push"],"sourceRoot":"","sources":["/Users/zhuxiaoxiao/Desktop/Group5_BT3103-2/frontend/src/components/Cart.vue"],"sourcesContent":["<template v-if=\"user\">\n<table>\n    <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n        <tr>\n            <div class=\"burger\">\n            <td>\n                <div class=\"row\">\n                        <h4>{{ item.name }}</h4>\n                </div>\n            </td>\n            <td>${{ item.price }}</td>\n            <td>\n                <button class=\"minus\" @click=\"minus(item.name)\" type=\"button\">-</button>\n                <input type=\"number\" :value=\"item.amount\" min=\"1\" :id=\"item.name\">\n                <button  class=\"plus\" @click = \"plus(item.name)\" type=\"button\">+</button>\n            </td>\n            <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n            <td>\n                <button class=\"delete\" @click=\"new_delete(item.name);\">Delete</button>\n            </td>\n        </div>\n        </tr>\n    </div>\n</table>\n<div class=\"empty_cart\" v-if=\"cart.length==0\">\n    <h2> There's nothing in your shopping cart! </h2>\n</div>\n    <button\n          @click=\"this.$router.push('/menu')\" \n          class=\"button\"><h3>Save and go back to Menu</h3>\n    </button>\n    <button class=\"order\" @click=\"make_payment\" >Make Payment</button>\n</template>\n<script>\n    import firebaseApp from '../firebase.js';\n    import {collection, getDocs} from \"firebase/firestore\";\n    import { getFirestore, doc, updateDoc,deleteDoc} from \"firebase/firestore\"\n    import {getAuth, onAuthStateChanged} from 'firebase/auth';\n\n    const db = getFirestore(firebaseApp);\n\texport default {\n        name: 'cart',\n    data() {\n        return {\n\t\tcart: [],\n        user: false\n    }\n\t},\n\tasync mounted() {\n        const auth = getAuth();\n        onAuthStateChanged(auth, async (user)=>{\n            if (user) { \n                this.user=user;\n                await this.getAll();\n            } \n            });\n        //await this.getAll();\n\t},\n\n    methods: {\n\t\tasync getAll() {\n            const auth = await getAuth();\n\t\t\ttry {\n                console.log(auth.currentUser.email)\n\t\t\t\tconst cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n\t\t\t\tconst q = await getDocs(cartRef) //get all docs in collection\n\t\t\t\tq.forEach((doc) => {\n\t\t\t\t\tthis.cart = [...this.cart, doc.data(), ] //push to cart array\n\t\t\t\t});\n\t\t\t\tconsole.log(this.cart)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e);\n\t\t\t}\n\t\t},\n        plus(id){\n            const auth = getAuth();\n            var a = document.getElementById(id).value\n            try{\n                a ++\n                document.getElementById(id).value = a\n                const d_minus={\n                    amount: a\n                }\n                updateDoc(doc(db, String(auth.currentUser.email), id), d_minus)\n                for (let i = 0; i < this.cart.length; i++) {\n                if (this.cart[i].name == id){\n                    this.cart[i].amount ++\n                }\n            }\n            }\n            catch(error){\n                console.error(\"Error adding:  \", error)\n            }\n\n        },\n        minus(id){\n            const auth = getAuth();\n            var a = document.getElementById(id).value\n            try{\n                if (a <= 1) {\n                    a = 1\n                } else{\n                    a -=1\n                    for (let i = 0; i < this.cart.length; i++) {\n                    if (this.cart[i].name == id){\n                        this.cart[i].amount --\n                    }\n                }\n                }\n                document.getElementById(id).value = a\n                const d_plus={\n                    amount: a\n                }\n                updateDoc(doc(db, String(auth.currentUser.email), id), d_plus)\n            }\n            catch(error){\n                console.error(\"Error removing item!\")\n            }\n        },\n        subtotal(amount, price){\n            return amount * price\n        },\n        new_delete(item){\n        const auth = getAuth();\n        try{\n            deleteDoc(doc(db, String(auth.currentUser.email), item))\n            for (let i = 0; i < this.cart.length; i++) {\n                if (this.cart[i].name == item){\n                    this.cart.splice(i, 1)\n                }\n            }\n            alert(\"Delete successfully!\")\n        }\n        catch(error){\n                console.error(\"Error removing item!\")\n            }\n        },\n        make_payment(){\n            if (this.cart.length == 0) {\n                alert(\"There's nothing in your cart!\")\n            } else {\n                this.$router.push('/payment')\n            }\n        }\n    },\n}\n</script>\n<style scoped>\ntd{\n    /*padding: 15px;*/\n    width: 300px;\n}\n.button, .order{\n    background-color: #c77414;\n\tcolor: white;\n  display:block;\n  border-radius: 12px;\n\tfont-weight: bold;\n  /*font-size: 15px;*/\n  font-size: 2vw;\n  padding: 15px;\n  width: 40%;\n  margin: auto;\n  margin-bottom: 5px;\n}\n.empty_cart{\n    text-align: center;\n}\ntable, td, th {\n  border: 1px solid black;\n}\n</style>\n"]}]}
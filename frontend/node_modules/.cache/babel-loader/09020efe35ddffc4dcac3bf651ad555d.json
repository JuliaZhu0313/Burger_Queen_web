{"remainingRequest":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue","mtime":1668471679383},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/babel.config.js","mtime":1668471151425},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668471153424},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js","mtime":1668471153308},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668471153424},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1668471157988}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBOYXZCYXIgZnJvbSAnQC9jb21wb25lbnRzL05hdkJhci52dWUnOwppbXBvcnQgZmlyZWJhc2VBcHAgZnJvbSAnLi4vZmlyZWJhc2UuanMnOwppbXBvcnQgeyBjb2xsZWN0aW9uLCBnZXREb2NzIH0gZnJvbSAiZmlyZWJhc2UvZmlyZXN0b3JlIjsKaW1wb3J0IHsgZ2V0RmlyZXN0b3JlIH0gZnJvbSAiZmlyZWJhc2UvZmlyZXN0b3JlIjsKaW1wb3J0IHsgZ2V0QXV0aCwgb25BdXRoU3RhdGVDaGFuZ2VkIH0gZnJvbSAnZmlyZWJhc2UvYXV0aCc7CmltcG9ydCB7IGRvYywgc2V0RG9jLCBkZWxldGVEb2MgfSBmcm9tICJmaXJlYmFzZS9maXJlc3RvcmUiOwpjb25zdCBkYiA9IGdldEZpcmVzdG9yZShmaXJlYmFzZUFwcCk7CmNvbnN0IGF1dGggPSBnZXRBdXRoKCk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncGF5bWVudCcsCiAgY29tcG9uZW50czogewogICAgTmF2QmFyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FydDogW10sCiAgICAgIHVzZXI6IGZhbHNlLAogICAgICBwYWlkOiBmYWxzZSwKICAgICAgb3JkZXI6IFtdCiAgICB9OwogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIG9uQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBhc3luYyB1c2VyID0+IHsKICAgICAgaWYgKHVzZXIpIHsKICAgICAgICB0aGlzLnVzZXIgPSB1c2VyOwogICAgICAgIGF3YWl0IHRoaXMuZ2V0QWxsKCk7CiAgICAgICAgaWYgKHRoaXMuY2FydC5sZW5ndGggPT0gMCkgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9tZW51Jyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldEFsbCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBwYXRoMSA9IFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSArICdfb3JkZXJzJzsKICAgICAgICAvL1RPRE8tLT5wYWdpbmF0aW9uCiAgICAgICAgY29uc29sZS5sb2coYXV0aC5jdXJyZW50VXNlci5lbWFpbCk7CiAgICAgICAgY29uc3QgY2FydFJlZiA9IGNvbGxlY3Rpb24oZGIsIFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSk7IC8vcmVmcmVuY2UgdGhlIGNvbGxlY3Rpb24KICAgICAgICBjb25zdCBxID0gYXdhaXQgZ2V0RG9jcyhjYXJ0UmVmKTsgLy9nZXQgYWxsIGRvY3MgaW4gY29sbGVjdGlvbgogICAgICAgIGNvbnN0IG9yZGVyUmVmID0gY29sbGVjdGlvbihkYiwgcGF0aDEpOwogICAgICAgIGNvbnN0IGEgPSBhd2FpdCBnZXREb2NzKG9yZGVyUmVmKTsKICAgICAgICBxLmZvckVhY2goZG9jID0+IHsKICAgICAgICAgIHRoaXMuY2FydCA9IFsuLi50aGlzLmNhcnQsIGRvYy5kYXRhKCldOyAvL3B1c2ggdG8gY2FydCBhcnJheQogICAgICAgIH0pOwoKICAgICAgICBhLmZvckVhY2goZG9jID0+IHsKICAgICAgICAgIC8vY29uc29sZS5sb2coIkRhdGEgcmVhZCBpcyAiICsgZG9jLmRhdGEoKSkKICAgICAgICAgIHRoaXMub3JkZXIgPSBbLi4udGhpcy5vcmRlciwgZG9jLmRhdGEoKV07IC8vcHVzaCB0byBvcmRlciBhcnJheQogICAgICAgICAgLy9jb25zb2xlLmxvZygiRGF0YSByZWFkIGlzICIgKyBkb2MuZGF0YSgpKQogICAgICAgIH0pOwoKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm9yZGVyKTsKICAgICAgICAvL2NvbnNvbGUubG9nKCJjb250ZW50IGluIG9yZGVyIGxpc3Q6ICIgKyB0aGlzLm9yZGVyLmxlbmd0aCkKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB9CiAgICB9LAogICAgc3VidG90YWwoYW1vdW50LCBwcmljZSkgewogICAgICByZXR1cm4gYW1vdW50ICogcHJpY2U7CiAgICB9LAogICAgdG90YWwoKSB7CiAgICAgIHZhciBzdW0gPSAwOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FydC5sZW5ndGg7IGkrKykgewogICAgICAgIHN1bSArPSB0aGlzLmNhcnRbaV0uYW1vdW50ICogdGhpcy5jYXJ0W2ldLnByaWNlOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKHN1bSk7CiAgICAgIHJldHVybiBzdW07CiAgICB9LAogICAgYXN5bmMgbWFrZV9wYXkoKSB7CiAgICAgIGNvbnN0IHVuaXF1ZV9udW0gPSBTdHJpbmcodGhpcy5vcmRlci5sZW5ndGggKyAxKTsKICAgICAgY29uc3QgcGF0aCA9IFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSArICdfb3JkZXJzJzsKICAgICAgdmFyIG5hbWUxID0gW107CiAgICAgIHZhciBhbW91bnQxID0gW107CiAgICAgIHZhciBwcmljZTEgPSBbXTsKICAgICAgY29uc3QgZGF0ZTEgPSBuZXcgRGF0ZSgpOwogICAgICBjb25zb2xlLmxvZygiY2FydCBsZW5ndGggaXMgOiAiICsgdGhpcy5jYXJ0Lmxlbmd0aCk7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNhcnQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIG5hbWUxLnB1c2godGhpcy5jYXJ0W2ldLm5hbWUpOwogICAgICAgICAgYW1vdW50MS5wdXNoKHRoaXMuY2FydFtpXS5hbW91bnQpOwogICAgICAgICAgcHJpY2UxLnB1c2godGhpcy5jYXJ0W2ldLnByaWNlKTsKICAgICAgICAgIGF3YWl0IGRlbGV0ZURvYyhkb2MoZGIsIFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSwgdGhpcy5jYXJ0W2ldLm5hbWUpKTsKICAgICAgICB9CiAgICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICAgIG5hbWU6IG5hbWUxLAogICAgICAgICAgYW1vdW50OiBhbW91bnQxLAogICAgICAgICAgcHJpY2U6IHByaWNlMSwKICAgICAgICAgIGRhdGU6IGRhdGUxCiAgICAgICAgfTsKICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICBhd2FpdCBzZXREb2MoZG9jKGRiLCBwYXRoLCB1bmlxdWVfbnVtKSwgZGF0YSk7CiAgICAgICAgdGhpcy5jYXJ0LnNwbGljZSgwLCB0aGlzLmNhcnQubGVuZ3RoKTsKICAgICAgICBhbGVydCgiUGFpZCBzdWNjZXNzZnVsbHQiKTsKICAgICAgICB0aGlzLnBhaWQgPSB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"mappings":"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","names":["NavBar","firebaseApp","collection","getDocs","getFirestore","getAuth","onAuthStateChanged","doc","setDoc","deleteDoc","db","auth","name","components","data","cart","user","paid","order","mounted","getAll","length","$router","push","methods","path1","String","currentUser","email","console","log","cartRef","q","orderRef","a","forEach","e","subtotal","amount","price","total","sum","i","make_pay","unique_num","path","name1","amount1","price1","date1","Date","date","splice","alert"],"sourceRoot":"","sources":["/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue"],"sourcesContent":["<template v-if=\"user\">\n    <NavBar />\n    <div class =\"payment\">\n        <h1 class=\"section-title\">Your Order</h1>\n        <table>\n      <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n          <tr>\n              <div class=\"burger\">\n              <td data-th=\"Product\">\n                  <div class=\"row\">\n                      <div>\n                          <h4>{{ item.name }}</h4>\n                      </div>\n                  </div>\n              </td>\n              <td data-th=\"Price\">${{ item.price }}</td>\n              <td data-th=\"Quantity\">\n              </td>\n              <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n              \n              </div>\n          </tr>\n      </div>\n        </table>\n    <div class=\"pay_btn\" v-if=\"paid == false\">\n        <h2 data-th=\"Total\" class=\"text-center\">Total: ${{total()}}</h2>\n        <button @click=\"make_pay\"> Make Payment </button>\n    </div>\n    <div class=\"imagebox\" v-if=\"paid\">\n        <img src=\"@/assets/table.png\">\n        <div class=\"bottom-bar\">\n        <div class = \"first_line\">Successfully Paid!</div>\n        <div class = \"second_line\">We are now preparing your food...please wait</div>\n        <button\n                @click=\"this.$router.push('/order')\" \n                class=\"button\"><h3>Check my order status</h3>\n        </button>\n        </div>\n    </div>\n</div>\n  \n        \n  \n    </template>\n  \n  <script>\n  import NavBar from '@/components/NavBar.vue'\n  import firebaseApp from '../firebase.js';\n  import {collection, getDocs} from \"firebase/firestore\";\n  import { getFirestore } from \"firebase/firestore\"\n  import {getAuth, onAuthStateChanged} from 'firebase/auth';\n  import { doc, setDoc,deleteDoc} from \"firebase/firestore\";\n\n  const db = getFirestore(firebaseApp);\n  const auth = getAuth();\n  export default {\n      name: 'payment',\n      components:{\n            NavBar,},\n  data() {\n      return {\n      cart: [],\n      user: false,\n      paid: false,\n      order: [],\n      }\n     \n  },\n  async mounted() {\n  onAuthStateChanged(auth, async (user)=>{\n  if (user) { \n      this.user=user;\n      await this.getAll();\n      if (this.cart.length == 0) {\n        this.$router.push('/menu');\n    }\n  }\n  });\n  },\n  methods: {\n      async getAll() {\n          try {\n              const path1 = String(auth.currentUser.email) + '_orders'\n              //TODO-->pagination\n              console.log(auth.currentUser.email)\n              const cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n              const q = await getDocs(cartRef) //get all docs in collection\n              const orderRef = collection(db, path1)\n              const a = await getDocs(orderRef)\n              \n              q.forEach((doc) => {\n                  this.cart = [...this.cart, doc.data(), ] //push to cart array\n              });\n              a.forEach((doc) => {\n                  //console.log(\"Data read is \" + doc.data())\n                  this.order = [...this.order, doc.data(), ] //push to order array\n                  //console.log(\"Data read is \" + doc.data())\n              });\n              console.log(this.order)\n              //console.log(\"content in order list: \" + this.order.length)\n          } catch (e) {\n              console.log(e);\n          }\n      },\n      subtotal(amount, price){\n              return amount * price\n          },\n      total(){\n          var sum=0;\n          for(let i =0;i<this.cart.length;i++)\n          {\n          \n          sum += this.cart[i].amount*this.cart[i].price;\n          \n          }\n          console.log(sum);\n          return sum; \n      },\n      async make_pay(){\n        const unique_num = String(this.order.length + 1)\n        const path = String(auth.currentUser.email) + '_orders'\n        var name1 = []\n        var amount1 = []\n        var price1 = []\n        const date1 = new Date();\n        console.log(\"cart length is : \" + this.cart.length)\n        try{\n            for (var i = 0; i < this.cart.length; i++) {\n                name1.push(this.cart[i].name)\n                amount1.push(this.cart[i].amount)\n                price1.push(this.cart[i].price)\n                await deleteDoc(doc(db, String(auth.currentUser.email), this.cart[i].name));\n            }\n            const data = {\n                name: name1,\n                amount: amount1,\n                price: price1,\n                date: date1,\n            }\n            console.log(data)\n            await setDoc(doc(db, path, unique_num),data)\n            this.cart.splice(0,this.cart.length)\n            alert(\"Paid successfullt\")\n            this.paid = true\n        } catch(e) {\n            console.log(e);\n        }\n      }\n  }}\n  </script>\n  \n  <style scoped>\n  .payment{\n      text-align: center;\n  }\n  .item{\n      text-align: center;\n  }\n  td{\n      text-align: center;\n      padding: 15px;\n  }\n  .imagebox {\n    position: relative;\n    display: inline-block;\n  }\n  img {\n      width:  600px;\n      background-color:whitesmoke;\n              height: 300px;\n              object-fit: cover;\n              align-items: center;\n              margin-left: auto;\n              margin-right: auto;\n              position: relative;\n              vertical-align: middle;\n              border: 0;\n    border: 3px solid orangered;\n    border-radius: 12px;\n  }\n  .first_line {\n              position: absolute;\n              top: 40px;\n              left: 100px;\n              font-size: 50px;\n              color: orange\n          }\n    \n          .second_line{\n              position: absolute;\n              bottom: 150px;\n              left: 30px;\n              font-size: 25px;\n          }\n  .button {\n      position: absolute;\n      background-color: #c77414;\n      color: white;\n      margin:auto;\n      display:block;\n      border-radius: 12px;\n      font-weight: bold;\n      padding: 10px 40px;\n      bottom: 30px;\n      left: 170px;\n  }\n  </style>"]}]}
{"remainingRequest":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Cart.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Cart.vue","mtime":1667614531123},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/babel.config.js","mtime":1667614523440},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1667614525458},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js","mtime":1667614525329},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1667614525458},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1667614530728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGZpcmViYXNlQXBwIGZyb20gJy4uL2ZpcmViYXNlLmpzJzsKaW1wb3J0IHsgY29sbGVjdGlvbiwgZ2V0RG9jcyB9IGZyb20gImZpcmViYXNlL2ZpcmVzdG9yZSI7CmltcG9ydCB7IGdldEZpcmVzdG9yZSwgZG9jLCB1cGRhdGVEb2MsIGRlbGV0ZURvYyB9IGZyb20gImZpcmViYXNlL2ZpcmVzdG9yZSI7CmltcG9ydCB7IGdldEF1dGgsIG9uQXV0aFN0YXRlQ2hhbmdlZCB9IGZyb20gJ2ZpcmViYXNlL2F1dGgnOwpjb25zdCBkYiA9IGdldEZpcmVzdG9yZShmaXJlYmFzZUFwcCk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnY2FydCcsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhcnQ6IFtdLAogICAgICB1c2VyOiBmYWxzZQogICAgfTsKICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpOwogICAgb25BdXRoU3RhdGVDaGFuZ2VkKGF1dGgsIGFzeW5jIHVzZXIgPT4gewogICAgICBpZiAodXNlcikgewogICAgICAgIHRoaXMudXNlciA9IHVzZXI7CiAgICAgICAgYXdhaXQgdGhpcy5nZXRBbGwoKTsKICAgICAgfQogICAgfSk7CiAgICAvL2F3YWl0IHRoaXMuZ2V0QWxsKCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0QWxsKCkgewogICAgICBjb25zdCBhdXRoID0gYXdhaXQgZ2V0QXV0aCgpOwogICAgICB0cnkgewogICAgICAgIGNvbnNvbGUubG9nKGF1dGguY3VycmVudFVzZXIuZW1haWwpOwogICAgICAgIGNvbnN0IGNhcnRSZWYgPSBjb2xsZWN0aW9uKGRiLCBTdHJpbmcoYXV0aC5jdXJyZW50VXNlci5lbWFpbCkpOyAvL3JlZnJlbmNlIHRoZSBjb2xsZWN0aW9uCiAgICAgICAgY29uc3QgcSA9IGF3YWl0IGdldERvY3MoY2FydFJlZik7IC8vZ2V0IGFsbCBkb2NzIGluIGNvbGxlY3Rpb24KICAgICAgICBxLmZvckVhY2goZG9jID0+IHsKICAgICAgICAgIHRoaXMuY2FydCA9IFsuLi50aGlzLmNhcnQsIGRvYy5kYXRhKCldOyAvL3B1c2ggdG8gY2FydCBhcnJheQogICAgICAgIH0pOwoKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNhcnQpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgIH0KICAgIH0sCiAgICBwbHVzKGlkKSB7CiAgICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7CiAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnZhbHVlOwogICAgICB0cnkgewogICAgICAgIGErKzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkudmFsdWUgPSBhOwogICAgICAgIGNvbnN0IGRfbWludXMgPSB7CiAgICAgICAgICBhbW91bnQ6IGEKICAgICAgICB9OwogICAgICAgIHVwZGF0ZURvYyhkb2MoZGIsIFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSwgaWQpLCBkX21pbnVzKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FydC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMuY2FydFtpXS5uYW1lID09IGlkKSB7CiAgICAgICAgICAgIHRoaXMuY2FydFtpXS5hbW91bnQrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgYWRkaW5nOiAgIiwgZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgbWludXMoaWQpIHsKICAgICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTsKICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkudmFsdWU7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGEgPD0gMSkgewogICAgICAgICAgYSA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGEgLT0gMTsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJ0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNhcnRbaV0ubmFtZSA9PSBpZCkgewogICAgICAgICAgICAgIHRoaXMuY2FydFtpXS5hbW91bnQtLTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkudmFsdWUgPSBhOwogICAgICAgIGNvbnN0IGRfcGx1cyA9IHsKICAgICAgICAgIGFtb3VudDogYQogICAgICAgIH07CiAgICAgICAgdXBkYXRlRG9jKGRvYyhkYiwgU3RyaW5nKGF1dGguY3VycmVudFVzZXIuZW1haWwpLCBpZCksIGRfcGx1cyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgcmVtb3ZpbmcgaXRlbSEiKTsKICAgICAgfQogICAgfSwKICAgIHN1YnRvdGFsKGFtb3VudCwgcHJpY2UpIHsKICAgICAgcmV0dXJuIGFtb3VudCAqIHByaWNlOwogICAgfSwKICAgIG5ld19kZWxldGUoaXRlbSkgewogICAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpOwogICAgICB0cnkgewogICAgICAgIGRlbGV0ZURvYyhkb2MoZGIsIFN0cmluZyhhdXRoLmN1cnJlbnRVc2VyLmVtYWlsKSwgaXRlbSkpOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXJ0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAodGhpcy5jYXJ0W2ldLm5hbWUgPT0gaXRlbSkgewogICAgICAgICAgICB0aGlzLmNhcnQuc3BsaWNlKGksIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGVydCgiRGVsZXRlIHN1Y2Nlc3NmdWxseSEiKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciByZW1vdmluZyBpdGVtISIpOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["firebaseApp","collection","getDocs","getFirestore","doc","updateDoc","deleteDoc","getAuth","onAuthStateChanged","db","name","data","cart","user","mounted","auth","getAll","methods","console","log","currentUser","email","cartRef","String","q","forEach","e","plus","id","a","document","getElementById","value","d_minus","amount","i","length","error","minus","d_plus","subtotal","price","new_delete","item","splice","alert"],"sourceRoot":"","sources":["/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Cart.vue"],"sourcesContent":["<template v-if=\"user\">\n<table>\n    <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n        <tr>\n            <div class=\"burger\">\n            <td data-th=\"Product\">\n                <div class=\"row\">\n                    <div>\n                        <h4>{{ item.name }}</h4>\n                    </div>\n                </div>\n            </td>\n            <td data-th=\"Price\">${{ item.price }}</td>\n            <td data-th=\"Quantity\">\n                <button class=\"minus\" @click=\"minus(item.name)\" type=\"button\">-</button>\n                <input type=\"number\" :value=\"item.amount\" min=\"1\" :id=\"item.name\">\n                <button  class=\"plus\" @click = \"plus(item.name)\" type=\"button\">+</button>\n            </td>\n            <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n            <td>\n                <button class=\"delete\" @click=\"new_delete(item.name);\">Delete</button>\n            </td>\n        </div>\n        </tr>\n    </div>\n</table>\n<div class=\"empty_cart\" v-if=\"cart.length==0\">\n    <h2> There's nothing in your shopping cart! </h2>\n</div>\n    <button\n          @click=\"this.$router.push('/menu')\" \n          class=\"button\"><h3>Save and go back to Menu</h3>\n    </button>\n    <br><br>\n    <button \n          @click=\"this.$router.push('/payment')\"\n          class=\"order\">Make Payment</button>\n</template>\n<script>\n    import firebaseApp from '../firebase.js';\n    import {collection, getDocs} from \"firebase/firestore\";\n    import { getFirestore, doc, updateDoc,deleteDoc} from \"firebase/firestore\"\n    import {getAuth, onAuthStateChanged} from 'firebase/auth';\n\n    const db = getFirestore(firebaseApp);\n\texport default {\n        name: 'cart',\n    data() {\n        return {\n\t\tcart: [],\n        user: false\n    }\n\t},\n\tasync mounted() {\n        const auth = getAuth();\n        onAuthStateChanged(auth, async (user)=>{\n            if (user) { \n                this.user=user;\n                await this.getAll();\n            } \n            });\n        //await this.getAll();\n\t},\n\n    methods: {\n\t\tasync getAll() {\n            const auth = await getAuth();\n\t\t\ttry {\n                console.log(auth.currentUser.email)\n\t\t\t\tconst cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n\t\t\t\tconst q = await getDocs(cartRef) //get all docs in collection\n\t\t\t\tq.forEach((doc) => {\n\t\t\t\t\tthis.cart = [...this.cart, doc.data(), ] //push to cart array\n\t\t\t\t});\n\t\t\t\tconsole.log(this.cart)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e);\n\t\t\t}\n\t\t},\n        plus(id){\n            const auth = getAuth();\n            var a = document.getElementById(id).value\n            try{\n                a ++\n                document.getElementById(id).value = a\n                const d_minus={\n                    amount: a\n                }\n                updateDoc(doc(db, String(auth.currentUser.email), id), d_minus)\n                for (let i = 0; i < this.cart.length; i++) {\n                if (this.cart[i].name == id){\n                    this.cart[i].amount ++\n                }\n            }\n            }\n            catch(error){\n                console.error(\"Error adding:  \", error)\n            }\n\n        },\n        minus(id){\n            const auth = getAuth();\n            var a = document.getElementById(id).value\n            try{\n                if (a <= 1) {\n                    a = 1\n                } else{\n                    a -=1\n                    for (let i = 0; i < this.cart.length; i++) {\n                    if (this.cart[i].name == id){\n                        this.cart[i].amount --\n                    }\n                }\n                }\n                document.getElementById(id).value = a\n                const d_plus={\n                    amount: a\n                }\n                updateDoc(doc(db, String(auth.currentUser.email), id), d_plus)\n            }\n            catch(error){\n                console.error(\"Error removing item!\")\n            }\n        },\n        subtotal(amount, price){\n            return amount * price\n        },\n        new_delete(item){\n        const auth = getAuth();\n        try{\n            deleteDoc(doc(db, String(auth.currentUser.email), item))\n            for (let i = 0; i < this.cart.length; i++) {\n                if (this.cart[i].name == item){\n                    this.cart.splice(i, 1)\n                }\n            }\n            alert(\"Delete successfully!\")\n        }\n        catch(error){\n                console.error(\"Error removing item!\")\n            }\n        },\n    },\n}\n</script>\n<style scoped>\ntd{\n    padding: 15px;\n}\n.button, .order{\n    background-color: #c77414;\n\tcolor: white;\n    margin:auto;\n    display:block;\n    border-radius: 12px;\n\tfont-weight: bold;\n    padding: 10px 40px;\n}\n.empty_cart{\n    text-align: center;\n}\n</style>\n"]}]}
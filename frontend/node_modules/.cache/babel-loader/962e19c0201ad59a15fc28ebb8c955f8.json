{"remainingRequest":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue?vue&type=template&id=3a0cf106&scoped=true","dependencies":[{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue","mtime":1668471679383},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/babel.config.js","mtime":1668471151425},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668471153424},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/babel-loader/lib/index.js","mtime":1668471153308},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1668471157991},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668471153424},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1668471157988}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IHJlc29sdmVDb21wb25lbnQgYXMgX3Jlc29sdmVDb21wb25lbnQsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgY3JlYXRlRWxlbWVudFZOb2RlIGFzIF9jcmVhdGVFbGVtZW50Vk5vZGUsIHJlbmRlckxpc3QgYXMgX3JlbmRlckxpc3QsIEZyYWdtZW50IGFzIF9GcmFnbWVudCwgb3BlbkJsb2NrIGFzIF9vcGVuQmxvY2ssIGNyZWF0ZUVsZW1lbnRCbG9jayBhcyBfY3JlYXRlRWxlbWVudEJsb2NrLCB0b0Rpc3BsYXlTdHJpbmcgYXMgX3RvRGlzcGxheVN0cmluZywgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIHB1c2hTY29wZUlkIGFzIF9wdXNoU2NvcGVJZCwgcG9wU2NvcGVJZCBhcyBfcG9wU2NvcGVJZCB9IGZyb20gInZ1ZSI7CmltcG9ydCBfaW1wb3J0c18wIGZyb20gJ0AvYXNzZXRzL3RhYmxlLnBuZyc7CmNvbnN0IF93aXRoU2NvcGVJZCA9IG4gPT4gKF9wdXNoU2NvcGVJZCgiZGF0YS12LTNhMGNmMTA2IiksIG4gPSBuKCksIF9wb3BTY29wZUlkKCksIG4pOwpjb25zdCBfaG9pc3RlZF8xID0gewogIGNsYXNzOiAicGF5bWVudCIKfTsKY29uc3QgX2hvaXN0ZWRfMiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImgxIiwgewogIGNsYXNzOiAic2VjdGlvbi10aXRsZSIKfSwgIllvdXIgT3JkZXIiLCAtMSAvKiBIT0lTVEVEICovKSk7CmNvbnN0IF9ob2lzdGVkXzMgPSB7CiAgY2xhc3M6ICJidXJnZXIiCn07CmNvbnN0IF9ob2lzdGVkXzQgPSB7CiAgImRhdGEtdGgiOiAiUHJvZHVjdCIKfTsKY29uc3QgX2hvaXN0ZWRfNSA9IHsKICBjbGFzczogInJvdyIKfTsKY29uc3QgX2hvaXN0ZWRfNiA9IHsKICAiZGF0YS10aCI6ICJQcmljZSIKfTsKY29uc3QgX2hvaXN0ZWRfNyA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoInRkIiwgewogICJkYXRhLXRoIjogIlF1YW50aXR5Igp9LCBudWxsLCAtMSAvKiBIT0lTVEVEICovKSk7CmNvbnN0IF9ob2lzdGVkXzggPSB7CiAgImRhdGEtdGgiOiAiU3VidG90YWwiLAogIGNsYXNzOiAidGV4dC1jZW50ZXIiCn07CmNvbnN0IF9ob2lzdGVkXzkgPSB7CiAga2V5OiAwLAogIGNsYXNzOiAicGF5X2J0biIKfTsKY29uc3QgX2hvaXN0ZWRfMTAgPSB7CiAgImRhdGEtdGgiOiAiVG90YWwiLAogIGNsYXNzOiAidGV4dC1jZW50ZXIiCn07CmNvbnN0IF9ob2lzdGVkXzExID0gewogIGtleTogMSwKICBjbGFzczogImltYWdlYm94Igp9Owpjb25zdCBfaG9pc3RlZF8xMiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImltZyIsIHsKICBzcmM6IF9pbXBvcnRzXzAKfSwgbnVsbCwgLTEgLyogSE9JU1RFRCAqLykpOwpjb25zdCBfaG9pc3RlZF8xMyA9IHsKICBjbGFzczogImJvdHRvbS1iYXIiCn07CmNvbnN0IF9ob2lzdGVkXzE0ID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgoKSA9PiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogIGNsYXNzOiAiZmlyc3RfbGluZSIKfSwgIlN1Y2Nlc3NmdWxseSBQYWlkISIsIC0xIC8qIEhPSVNURUQgKi8pKTsKY29uc3QgX2hvaXN0ZWRfMTUgPSAvKiNfX1BVUkVfXyovX3dpdGhTY29wZUlkKCgpID0+IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgY2xhc3M6ICJzZWNvbmRfbGluZSIKfSwgIldlIGFyZSBub3cgcHJlcGFyaW5nIHlvdXIgZm9vZC4uLnBsZWFzZSB3YWl0IiwgLTEgLyogSE9JU1RFRCAqLykpOwpjb25zdCBfaG9pc3RlZF8xNiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoKCkgPT4gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImgzIiwgbnVsbCwgIkNoZWNrIG15IG9yZGVyIHN0YXR1cyIsIC0xIC8qIEhPSVNURUQgKi8pKTsKY29uc3QgX2hvaXN0ZWRfMTcgPSBbX2hvaXN0ZWRfMTZdOwpleHBvcnQgZnVuY3Rpb24gcmVuZGVyKF9jdHgsIF9jYWNoZSwgJHByb3BzLCAkc2V0dXAsICRkYXRhLCAkb3B0aW9ucykgewogIGNvbnN0IF9jb21wb25lbnRfTmF2QmFyID0gX3Jlc29sdmVDb21wb25lbnQoIk5hdkJhciIpOwogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soX0ZyYWdtZW50LCBudWxsLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfTmF2QmFyKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMSwgW19ob2lzdGVkXzIsIF9jcmVhdGVFbGVtZW50Vk5vZGUoInRhYmxlIiwgbnVsbCwgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlRWxlbWVudEJsb2NrKF9GcmFnbWVudCwgbnVsbCwgX3JlbmRlckxpc3QoJGRhdGEuY2FydCwgaXRlbSA9PiB7CiAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCB7CiAgICAgIGtleTogaXRlbS5uYW1lLAogICAgICBjbGFzczogImNhcnQxIgogICAgfSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoInRyIiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzMsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJ0ZCIsIF9ob2lzdGVkXzQsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF81LCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImg0IiwgbnVsbCwgX3RvRGlzcGxheVN0cmluZyhpdGVtLm5hbWUpLCAxIC8qIFRFWFQgKi8pXSldKV0pLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJ0ZCIsIF9ob2lzdGVkXzYsICIkIiArIF90b0Rpc3BsYXlTdHJpbmcoaXRlbS5wcmljZSksIDEgLyogVEVYVCAqLyksIF9ob2lzdGVkXzcsIF9jcmVhdGVFbGVtZW50Vk5vZGUoInRkIiwgX2hvaXN0ZWRfOCwgIlN1YnRvdGFsOiAkIiArIF90b0Rpc3BsYXlTdHJpbmcoJG9wdGlvbnMuc3VidG90YWwoaXRlbS5hbW91bnQsIGl0ZW0ucHJpY2UpKSwgMSAvKiBURVhUICovKV0pXSldKTsKICB9KSwgMTI4IC8qIEtFWUVEX0ZSQUdNRU5UICovKSldKSwgJGRhdGEucGFpZCA9PSBmYWxzZSA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIF9ob2lzdGVkXzksIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJoMiIsIF9ob2lzdGVkXzEwLCAiVG90YWw6ICQiICsgX3RvRGlzcGxheVN0cmluZygkb3B0aW9ucy50b3RhbCgpKSwgMSAvKiBURVhUICovKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiYnV0dG9uIiwgewogICAgb25DbGljazogX2NhY2hlWzBdIHx8IChfY2FjaGVbMF0gPSAoLi4uYXJncykgPT4gJG9wdGlvbnMubWFrZV9wYXkgJiYgJG9wdGlvbnMubWFrZV9wYXkoLi4uYXJncykpCiAgfSwgIiBNYWtlIFBheW1lbnQgIildKSkgOiBfY3JlYXRlQ29tbWVudFZOb2RlKCJ2LWlmIiwgdHJ1ZSksICRkYXRhLnBhaWQgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCBfaG9pc3RlZF8xMSwgW19ob2lzdGVkXzEyLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF8xMywgW19ob2lzdGVkXzE0LCBfaG9pc3RlZF8xNSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiYnV0dG9uIiwgewogICAgb25DbGljazogX2NhY2hlWzFdIHx8IChfY2FjaGVbMV0gPSAkZXZlbnQgPT4gdGhpcy4kcm91dGVyLnB1c2goJy9vcmRlcicpKSwKICAgIGNsYXNzOiAiYnV0dG9uIgogIH0sIF9ob2lzdGVkXzE3KV0pXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXSldLCA2NCAvKiBTVEFCTEVfRlJBR01FTlQgKi8pOwp9"},{"version":3,"mappings":";;OA6BaA,UAAwB;;;EA3B5BC,KAAK,EAAE;AAAS;gEACjBC,oBAAyC;EAArCD,KAAK,EAAC;AAAe,GAAC,YAAU;;EAIzBA,KAAK,EAAC;AAAQ;;EACf,SAAO,EAAC;AAAS;;EACZA,KAAK,EAAC;AAAK;;EAMhB,SAAO,EAAC;AAAO;gEACnBC,oBACK;EADD,SAAO,EAAC;AAAU;;EAElB,SAAO,EAAC,UAAU;EAACD,KAAK,EAAC;;;;EAMlCA,KAAK,EAAC;;;EACH,SAAO,EAAC,OAAO;EAACA,KAAK,EAAC;;;;EAGzBA,KAAK,EAAC;;iEACPC,oBAA8B;EAAzBC,GAAwB,EAAxBH;AAAwB;;EACxBC,KAAK,EAAC;AAAY;iEACvBC,oBAAkD;EAA7CD,KAAK,EAAG;AAAY,GAAC,oBAAkB;iEAC5CC,oBAA6E;EAAxED,KAAK,EAAG;AAAa,GAAC,8CAA4C;iEAGhDC,oBAA8B,YAA1B,uBAAqB;qBAAzBE,WAA8B;;;6DAlCzDC,aAAUC,oBACVJ,oBAqCE,OArCFK,UAqCE,GApCEC,UAAyC,EACzCN,oBAmBQ,mCAlBVO,oBAiBMC,6BAjBgBC,UAAI,EAAZC,IAAI;yBAAlBH,oBAiBM;MAjBuBI,GAAG,EAAED,IAAI,CAACE,IAAI;MAAEb,KAAK,EAAC;QAC/CC,oBAeK,aAdDA,oBAaM,OAbNa,UAaM,GAZNb,oBAMK,MANLc,UAMK,GALDd,oBAIM,OAJNe,UAIM,GAHFf,oBAEM,cADFA,oBAAwB,6BAAjBU,IAAI,CAACE,IAAI,wBAI5BZ,oBAA0C,MAA1CgB,UAA0C,EAAtB,GAAC,oBAAGN,IAAI,CAACO,KAAK,kBAClCC,UACK,EACLlB,oBAAkG,MAAlGmB,UAAkG,EAAvD,aAAW,oBAAGC,iBAAQ,CAACV,IAAI,CAACW,MAAM,EAAEX,IAAI,CAACO,KAAK;oCAMxER,UAAI,2BAA/BF,oBAGM,OAHNe,UAGM,GAFFtB,oBAAgE,MAAhEuB,WAAgE,EAAxB,UAAQ,oBAAEH,cAAK,oBACvDpB,oBAAiD;IAAxCwB,OAAK,yCAAEJ,+CAAQ;KAAE,gBAAc,0CAEhBX,UAAI,kBAAhCF,oBAUM,OAVNkB,WAUM,GATFC,WAA8B,EAC9B1B,oBAOM,OAPN2B,WAOM,GANNC,WAAkD,EAClDC,WAA6E,EAC7E7B,oBAGS;IAFAwB,OAAK,2CAAOM,OAAO,CAACC,IAAI;IACzBhC,KAAK,EAAC","names":["_imports_0","class","_createElementVNode","src","_hoisted_16","_createVNode","_component_NavBar","_hoisted_1","_hoisted_2","_createElementBlock","_Fragment","$data","item","key","name","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","price","_hoisted_7","_hoisted_8","$options","amount","_hoisted_9","_hoisted_10","onClick","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","$router","push"],"sourceRoot":"","sources":["/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue"],"sourcesContent":["<template v-if=\"user\">\n    <NavBar />\n    <div class =\"payment\">\n        <h1 class=\"section-title\">Your Order</h1>\n        <table>\n      <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n          <tr>\n              <div class=\"burger\">\n              <td data-th=\"Product\">\n                  <div class=\"row\">\n                      <div>\n                          <h4>{{ item.name }}</h4>\n                      </div>\n                  </div>\n              </td>\n              <td data-th=\"Price\">${{ item.price }}</td>\n              <td data-th=\"Quantity\">\n              </td>\n              <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n              \n              </div>\n          </tr>\n      </div>\n        </table>\n    <div class=\"pay_btn\" v-if=\"paid == false\">\n        <h2 data-th=\"Total\" class=\"text-center\">Total: ${{total()}}</h2>\n        <button @click=\"make_pay\"> Make Payment </button>\n    </div>\n    <div class=\"imagebox\" v-if=\"paid\">\n        <img src=\"@/assets/table.png\">\n        <div class=\"bottom-bar\">\n        <div class = \"first_line\">Successfully Paid!</div>\n        <div class = \"second_line\">We are now preparing your food...please wait</div>\n        <button\n                @click=\"this.$router.push('/order')\" \n                class=\"button\"><h3>Check my order status</h3>\n        </button>\n        </div>\n    </div>\n</div>\n  \n        \n  \n    </template>\n  \n  <script>\n  import NavBar from '@/components/NavBar.vue'\n  import firebaseApp from '../firebase.js';\n  import {collection, getDocs} from \"firebase/firestore\";\n  import { getFirestore } from \"firebase/firestore\"\n  import {getAuth, onAuthStateChanged} from 'firebase/auth';\n  import { doc, setDoc,deleteDoc} from \"firebase/firestore\";\n\n  const db = getFirestore(firebaseApp);\n  const auth = getAuth();\n  export default {\n      name: 'payment',\n      components:{\n            NavBar,},\n  data() {\n      return {\n      cart: [],\n      user: false,\n      paid: false,\n      order: [],\n      }\n     \n  },\n  async mounted() {\n  onAuthStateChanged(auth, async (user)=>{\n  if (user) { \n      this.user=user;\n      await this.getAll();\n      if (this.cart.length == 0) {\n        this.$router.push('/menu');\n    }\n  }\n  });\n  },\n  methods: {\n      async getAll() {\n          try {\n              const path1 = String(auth.currentUser.email) + '_orders'\n              //TODO-->pagination\n              console.log(auth.currentUser.email)\n              const cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n              const q = await getDocs(cartRef) //get all docs in collection\n              const orderRef = collection(db, path1)\n              const a = await getDocs(orderRef)\n              \n              q.forEach((doc) => {\n                  this.cart = [...this.cart, doc.data(), ] //push to cart array\n              });\n              a.forEach((doc) => {\n                  //console.log(\"Data read is \" + doc.data())\n                  this.order = [...this.order, doc.data(), ] //push to order array\n                  //console.log(\"Data read is \" + doc.data())\n              });\n              console.log(this.order)\n              //console.log(\"content in order list: \" + this.order.length)\n          } catch (e) {\n              console.log(e);\n          }\n      },\n      subtotal(amount, price){\n              return amount * price\n          },\n      total(){\n          var sum=0;\n          for(let i =0;i<this.cart.length;i++)\n          {\n          \n          sum += this.cart[i].amount*this.cart[i].price;\n          \n          }\n          console.log(sum);\n          return sum; \n      },\n      async make_pay(){\n        const unique_num = String(this.order.length + 1)\n        const path = String(auth.currentUser.email) + '_orders'\n        var name1 = []\n        var amount1 = []\n        var price1 = []\n        const date1 = new Date();\n        console.log(\"cart length is : \" + this.cart.length)\n        try{\n            for (var i = 0; i < this.cart.length; i++) {\n                name1.push(this.cart[i].name)\n                amount1.push(this.cart[i].amount)\n                price1.push(this.cart[i].price)\n                await deleteDoc(doc(db, String(auth.currentUser.email), this.cart[i].name));\n            }\n            const data = {\n                name: name1,\n                amount: amount1,\n                price: price1,\n                date: date1,\n            }\n            console.log(data)\n            await setDoc(doc(db, path, unique_num),data)\n            this.cart.splice(0,this.cart.length)\n            alert(\"Paid successfullt\")\n            this.paid = true\n        } catch(e) {\n            console.log(e);\n        }\n      }\n  }}\n  </script>\n  \n  <style scoped>\n  .payment{\n      text-align: center;\n  }\n  .item{\n      text-align: center;\n  }\n  td{\n      text-align: center;\n      padding: 15px;\n  }\n  .imagebox {\n    position: relative;\n    display: inline-block;\n  }\n  img {\n      width:  600px;\n      background-color:whitesmoke;\n              height: 300px;\n              object-fit: cover;\n              align-items: center;\n              margin-left: auto;\n              margin-right: auto;\n              position: relative;\n              vertical-align: middle;\n              border: 0;\n    border: 3px solid orangered;\n    border-radius: 12px;\n  }\n  .first_line {\n              position: absolute;\n              top: 40px;\n              left: 100px;\n              font-size: 50px;\n              color: orange\n          }\n    \n          .second_line{\n              position: absolute;\n              bottom: 150px;\n              left: 30px;\n              font-size: 25px;\n          }\n  .button {\n      position: absolute;\n      background-color: #c77414;\n      color: white;\n      margin:auto;\n      display:block;\n      border-radius: 12px;\n      font-weight: bold;\n      padding: 10px 40px;\n      bottom: 30px;\n      left: 170px;\n  }\n  </style>"]}]}
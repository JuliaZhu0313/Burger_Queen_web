{"remainingRequest":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue?vue&type=style&index=0&id=3a0cf106&scoped=true&lang=css","dependencies":[{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue","mtime":1668464183863},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/css-loader/dist/cjs.js","mtime":1668464178901},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1668464183420},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/postcss-loader/src/index.js","mtime":1668464181071},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1668464178055},{"path":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1668464183418}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLnBheW1lbnR7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICB9CiAgLml0ZW17CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICB9CiAgdGR7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgcGFkZGluZzogMTVweDsKICB9CiAgLmltYWdlYm94IHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB9CiAgaW1nIHsKICAgICAgd2lkdGg6ICA2MDBweDsKICAgICAgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZXNtb2tlOwogICAgICAgICAgICAgIGhlaWdodDogMzAwcHg7CiAgICAgICAgICAgICAgb2JqZWN0LWZpdDogY292ZXI7CiAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgICBtYXJnaW4tbGVmdDogYXV0bzsKICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87CiAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgICAgYm9yZGVyOiAwOwogICAgYm9yZGVyOiAzcHggc29saWQgb3JhbmdlcmVkOwogICAgYm9yZGVyLXJhZGl1czogMTJweDsKICB9CiAgLmZpcnN0X2xpbmUgewogICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgICB0b3A6IDQwcHg7CiAgICAgICAgICAgICAgbGVmdDogMTAwcHg7CiAgICAgICAgICAgICAgZm9udC1zaXplOiA1MHB4OwogICAgICAgICAgICAgIGNvbG9yOiBvcmFuZ2UKICAgICAgICAgIH0KICAgIAogICAgICAgICAgLnNlY29uZF9saW5lewogICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgICBib3R0b206IDE1MHB4OwogICAgICAgICAgICAgIGxlZnQ6IDMwcHg7CiAgICAgICAgICAgICAgZm9udC1zaXplOiAyNXB4OwogICAgICAgICAgfQogIC5idXR0b24gewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNjNzc0MTQ7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgbWFyZ2luOmF1dG87CiAgICAgIGRpc3BsYXk6YmxvY2s7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICBwYWRkaW5nOiAxMHB4IDQwcHg7CiAgICAgIGJvdHRvbTogMzBweDsKICAgICAgbGVmdDogMTcwcHg7CiAgfQogIA=="},{"version":3,"sources":["/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue"],"names":[],"mappings":"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","file":"/Users/zhongyitong/Downloads/bt3103/Group5_BT3103/frontend/src/components/Payment.vue","sourceRoot":"","sourcesContent":["<template v-if=\"user\">\n  <NavBar />\n    <div class =\"payment\">\n        <h1 class=\"section-title\">Your Order</h1>\n        <table>\n      <div v-for = \"item in cart\" :key=\"item.name\" class=\"cart1\">\n          <tr>\n              <div class=\"burger\">\n              <td data-th=\"Product\">\n                  <div class=\"row\">\n                      <div>\n                          <h4>{{ item.name }}</h4>\n                      </div>\n                  </div>\n              </td>\n              <td data-th=\"Price\">${{ item.price }}</td>\n              <td data-th=\"Quantity\">\n              </td>\n              <td data-th=\"Subtotal\" class=\"text-center\">Subtotal: ${{ subtotal(item.amount, item.price) }}</td>\n              \n              </div>\n          </tr>\n      </div>\n        </table>\n    <div class=\"pay_btn\" v-if=\"paid == false\">\n        <h2 data-th=\"Total\" class=\"text-center\">Total: ${{total()}}</h2>\n        <button @click=\"make_pay\"> Make Payment </button>\n    </div>\n    <div class=\"imagebox\" v-if=\"paid\">\n        <img src=\"@/assets/table.png\">\n        <div class=\"bottom-bar\">\n        <div class = \"first_line\">Successfully Paid!</div>\n        <div class = \"second_line\">We are now preparing your food...please wait</div>\n        <button\n                @click=\"this.$router.push('/order')\" \n                class=\"button\"><h3>Check my order status</h3>\n        </button>\n        </div>\n    </div>\n</div>\n  \n        \n  \n    </template>\n  \n  <script>\n  import NavBar from '@/components/NavBar.vue'\n  import firebaseApp from '../firebase.js';\n  import {collection, getDocs} from \"firebase/firestore\";\n  import { getFirestore } from \"firebase/firestore\"\n  import {getAuth, onAuthStateChanged} from 'firebase/auth';\n  import { doc, setDoc,deleteDoc} from \"firebase/firestore\";\n\n  const db = getFirestore(firebaseApp);\n  const auth = getAuth();\n  export default {\n      name: 'payment',\n      components:{\n            NavBar,},\n  data() {\n      return {\n      cart: [],\n      user: false,\n      paid: false,\n      order: [],\n      }\n     \n  },\n  async mounted() {\n  onAuthStateChanged(auth, async (user)=>{\n  if (user) { \n      this.user=user;\n      await this.getAll();\n      if (this.cart.length == 0) {\n        this.$router.push('/menu');\n    }\n  }\n  });\n  },\n  methods: {\n      async getAll() {\n          try {\n              const path1 = String(auth.currentUser.email) + '_orders'\n              //TODO-->pagination\n              console.log(auth.currentUser.email)\n              const cartRef = collection(db, String(auth.currentUser.email)) //refrence the collection\n              const q = await getDocs(cartRef) //get all docs in collection\n              const orderRef = collection(db, path1)\n              const a = await getDocs(orderRef)\n              \n              q.forEach((doc) => {\n                  this.cart = [...this.cart, doc.data(), ] //push to cart array\n              });\n              a.forEach((doc) => {\n                  //console.log(\"Data read is \" + doc.data())\n                  this.order = [...this.order, doc.data(), ] //push to order array\n                  //console.log(\"Data read is \" + doc.data())\n              });\n              console.log(this.order)\n              //console.log(\"content in order list: \" + this.order.length)\n          } catch (e) {\n              console.log(e);\n          }\n      },\n      subtotal(amount, price){\n              return amount * price\n          },\n      total(){\n          var sum=0;\n          for(let i =0;i<this.cart.length;i++)\n          {\n          \n          sum += this.cart[i].amount*this.cart[i].price;\n          \n          }\n          console.log(sum);\n          return sum; \n      },\n      async make_pay(){\n        const unique_num = String(this.order.length + 1)\n        const path = String(auth.currentUser.email) + '_orders'\n        var name1 = []\n        var amount1 = []\n        var price1 = []\n        const date1 = new Date();\n        console.log(\"cart length is : \" + this.cart.length)\n        try{\n            for (var i = 0; i < this.cart.length; i++) {\n                name1.push(this.cart[i].name)\n                amount1.push(this.cart[i].amount)\n                price1.push(this.cart[i].price)\n                await deleteDoc(doc(db, String(auth.currentUser.email), this.cart[i].name));\n            }\n            const data = {\n                name: name1,\n                amount: amount1,\n                price: price1,\n                date: date1,\n            }\n            console.log(data)\n            await setDoc(doc(db, path, unique_num),data)\n            this.cart.splice(0,this.cart.length)\n            alert(\"Paid successfullt\")\n            this.paid = true\n        } catch(e) {\n            console.log(e);\n        }\n      }\n  }}\n  </script>\n  \n  <style scoped>\n  .payment{\n      text-align: center;\n  }\n  .item{\n      text-align: center;\n  }\n  td{\n      text-align: center;\n      padding: 15px;\n  }\n  .imagebox {\n    position: relative;\n    display: inline-block;\n  }\n  img {\n      width:  600px;\n      background-color:whitesmoke;\n              height: 300px;\n              object-fit: cover;\n              align-items: center;\n              margin-left: auto;\n              margin-right: auto;\n              position: relative;\n              vertical-align: middle;\n              border: 0;\n    border: 3px solid orangered;\n    border-radius: 12px;\n  }\n  .first_line {\n              position: absolute;\n              top: 40px;\n              left: 100px;\n              font-size: 50px;\n              color: orange\n          }\n    \n          .second_line{\n              position: absolute;\n              bottom: 150px;\n              left: 30px;\n              font-size: 25px;\n          }\n  .button {\n      position: absolute;\n      background-color: #c77414;\n      color: white;\n      margin:auto;\n      display:block;\n      border-radius: 12px;\n      font-weight: bold;\n      padding: 10px 40px;\n      bottom: 30px;\n      left: 170px;\n  }\n  </style>"]}]}